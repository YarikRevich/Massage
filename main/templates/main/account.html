{% extends 'layout/base.html' %}
{% load static %}
{% load i18n %}
{% block title %}
{% trans 'Учётная запись'%}
{% endblock title%}
{% block link%} 
<link rel="stylesheet" href="{% static "css/account30.css"%}">
{% endblock link %}
{% block content %}
<div class="articles">

    <!-- The main part of the account page-->
    <div class="everything">
        <div class="main-info">

            <!-- The part of the authentication-->
            {% if form is not None %}
            <div class="auth-part">
                <div class="need-auth-text">
                    <div class="info-text auth-text">{% trans 'Для продолжения роботы требуеться пройти авторизацию'%}</div>
                </div>
                <div class="user-auth-form-parent">
                    <form class="user-auth-form" method="POST">
                        {% csrf_token %}
                        {{form.username}}
                        {{form.password}}
                        <div class="custom-control custom-checkbox">
                            <input type="checkbox" name="check" class="custom-control-input" id="customCheck1">
                            <label class="custom-control-label" for="customCheck1">{% trans 'Вход по умолчанию'%}</label>
                        </div>
                        <div class="login-button-parent">
                            <button type="submit" class="orange-button login-button">{% trans 'Войти'%}</button>
                        </div>
                        <div class="auth-social-media">
                            <a href="{% url 'social:begin' 'facebook' %}"><img width="50em" src="{% static 'favicon/facebook.png' %}"></a>
                            <a href="{% url "social:begin" "google-oauth2" %}"><img width="50em" src="{%static 'favicon/au-google.png' %}"></a>
                        </div>
                        <div class="tips">                
                            <div>{% trans 'Забыли пароль?|'%}</div>
                            <div><a href="{% url "Reg" %}" class="regestration-link">{% trans 'Зарегистрироваться!'%}</a></div>
                        </div>
                    </form>
                </div>
            </div>
            {% else %}
            
            <!-- The part of the user's information -->
            <div class="info-block">
                <div class="info-text">
                    <span>{% trans 'Карточка клиента'%}</span>
                </div>
            </div>
            <div class="about-block">
                {% for name,data in user_data %}
                    <div class="about">
                        <div class="about-title">
                            <span>{{name}}</span>
                        </div>
                        <div class="about-text">
                            <span>{{data}}</span>
                        </div>
                    </div>
                {% endfor %}
            </div>
            {% endif %}
        </div>    

        <!-- The part of some information about made records -->
        <div class="info">
            <div class="devided-line"></div>
            <div class="record-area-title">{% trans 'История записей'%}</div>
            <div class="record-area-line-parent">
                <div class="record-area-line"></div>
            </div>

            <div class="cards">
                {% if form is None%}
                    {% for record in records %}

                        <!-- The part of the record cards -->
                        <div class="card">
                            <div class="card-header">
                                <div class="name_of_service">{% trans 'Услуга:'%}{{record.name}}</div>
                            </div>
                            <div class="card-body">
                                <p class="card-text">{{record.description}}</p>
                                <div class="status-bar-line"></div>
                                {% if record.seen %}
                                    <p>{% trans 'Статус заявки:'%}<span class="record-text">{% trans 'Просмотрено'%}</span></p>
                                {% else %}
                                    <p>{% trans 'Статус заявки:'%}<span class="record-text">{% trans 'Отослано'%}</span></p>
                                {% endif %}
                                        
                                 {% if record.status %}
                                    <p>{% trans 'Статус выполнения:'%}<span class="record-text">{% trans 'Завершено'%}</span></p>
                                    <div class="button-div">
                                        <button type="button" class="rec-button-disabled"><span title={% trans "Вы не можете удалить запись так как сеанс уже был"%}>{% trans 'Удалить запись'%}</span></button>
                                    </div>
                                {% else %}
                                    <p>С{% trans 'Статус выполнения:'%}<span class="record-text">{% trans 'Неизвестно'%}</span></p>
                                    <div class="button-div">
                                        <a href="{% url 'DeleteRecord' pk=record.pk %}"><button type="button" class="red-button">{% trans 'Удалить запись'%}</button></a>
                                    </div>
                                {% endif %}
                            </div>
                        </div>
                    {% empty %}
                    {% if made_records and made_records is not None %}

                    <!-- A part of the message which is stated when user deleted all the made but not finished records -->
                    <div class="empty-message-area">
                        <h2 class="big-text">{% trans 'Ваш архив пуст'%}</h2>
                    </div>
                    {% else %}

                    <!-- A part of the message which is stated when user has never made any records -->
                    <div class="empty-message-area">
                        <h2 class="big-text">{% trans 'У вас пока не было записей'%}</h2>
                        <a class="orange-button" href="{% url 'Services' %}">{% trans 'Записаться впервые!'%}</a>
                    </div>
                    {% endif %}
                    {% endfor %}
                {% else %}

                    <!-- A part of the message which is stated when user is not authed -->
                    <div class="empty-message-area">
                        <h2 class="big-text">{% trans 'Вы не авторизованы!'%}</h2>
                    </div>
                {% endif %}
            </div>
        </div>
    </div>
</div>
{% endblock content %}